<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <title>E-Docs</title>
  <style>
    body {
      display: flex;
      flex-direction: column;
      align-items: center;
      height: 560px;
    }

    body textarea {
      flex: 1;
      width: 100%;
    }
  </style>
</head>

<body>
  <h1 id="h1">Archivo actual es</h1>
  <textarea rows="24" cols="50" name="main-content" id="main-content"></textarea>
</body>

<script>
  const $ = require('jquery')
  $(document).ready(() => {
    const ipc = require('electron').ipcRenderer
    const mainContent = $('#main-content')
    const h1 = $('#h1')

    ipc.on('stateChange', (event, response) => {
      mainContent.val(response.text);
      h1.text(response.fileName);
    })

    ipc.on('unlock', (event, response) => {
      mainContent.prop('disabled', false)
      mainContent.focus()
    })

    mainContent.on('input propertychange', () => {
      const cursorPosition = mainContent.prop("selectionStart")
      ipc.send('invokeAction', {text: mainContent.val(), cursorPosition})
      mainContent.prop('disabled', true)
    })

    ipc.send('documentReady')
  })
</script>

</html>
